<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
	content="initial-scale=1,maximum-scale=1, minimum-scale=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>初始绑定电话号码</title>
<link rel="stylesheet" href="/QRCode/css/modBind.css">

</head>
<body>
	<header
		style="background: #ec5224; width: 100%; height: 50px; text-align: center; line-height: 50px;">
		<img
			style="width: 50px; height: 50px; float: left; z-index: 999999999;"
			onclick="window.history.go(-1)" src="/QRCode/img/rpw_back_n.png" />
		<span style="font-size: 14px; color: #fff;">绑定你的电话号码</span>
	</header>
	<div class="pc-kk-form" id="subForm">
		<form action="">
			<div class="pc-kk-form-list">
				<input type="text" id="userPhone" placeholder="手机号码" valid="phone"
					tips="请正确填写电话号码!">
			</div>
			<div class="pc-kk-form-list" style="width:100%;">
				<input not="not" valid="Required" tips="请正确填写图像验证码!" type="text" id="tux" style="width:70%;" ><img src="/QRCode/img/yzm.png" style="width:100px;" />
			</div>
			<div style="margin-top: 10px;"></div>
			<div class="pc-kk-form-list pc-kk-form-list-clear">
				<div class="_childe" name="_childe" style="width: 65%">
					<input type="text" id="validCode" placeholder="验证码"
						valid="required" tips="验证码不能为空!">
				</div>
				<div class="_childe" id="_getCode" name="_getCode"
					style="width: 33%; float: right; background-color: #4cd463; color: white; text-align: center; cursor: pointer;">
					获取验证码</div>
			</div>
			<div class="pc-kk-form-list">
				<input type="text" id="userMessage" placeholder="留言">
			</div>
			<div class="pc-kk-form-btn">
				<button id="_bottom_sub" not='not'>提交</button>
			</div>
			<input type="hidden" id="openid" th:value="${openid}" />
		</form>
	</div>



	<script type="text/javascript" src="/utils/js/jquery.min.js"></script>
	<script src="/utils/js/utils.js" type="text/javascript"></script>
	<script src="/utils/js/constant.js" type="text/javascript"></script>
	<script>
		window.onload = function() {
			$('#_getCode').click(function() {
				var thenVal = $('#userPhone').val();
				var phoneReg = /(^1[3|4|5|7|8]\d{9}$)|(^09\d{8}$)/;
				if (!phoneReg.test(thenVal)) {
					entity.codeNPass($('#userPhone'));
					return;
				}
				entity.codeDom = "_getCode";
				entity.codeText = {
					bef : 'S',
					aft : '获取'
				};
				entity.getCode(_getSMSCode, {
					telephone : thenVal
				});
			})
			function _submit() {
				var params = validateFrom('subForm');
				if (params.res) {
					console.log('pass');
					_ajax({
						url : _userBindPhone,
						data : params,
						success : function(data) {
							window.history.go(-1);
						}
					})
				} else {
					console.log('nopass');
				}
			}
			$("#_bottom_sub").click(function() {
				_submit();
				return false;
			})
		}
	</script>

</body>
</html>